<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Iniciar Sesión</title>
  <link rel="stylesheet" href="/css/Login.css" />
  <link rel="stylesheet" href="/css/global.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">


</head>
<body>
<div class="login-wrapper">
  <div class="login-card">
    <h2>Inicio de Sesión</h2>
    <form action="/login" method="POST" id="login-form">
      <div class="role-buttons">
        <button type="button" class="role-btn activo" data-role="alumno">
          <i class="fas fa-user-graduate"></i> Alumno
        </button>
        <button type="button" class="role-btn" data-role="docente">
          <i class="fas fa-chalkboard-teacher"></i> Docente
        </button>
        <button type="button" class="role-btn" data-role="administrativo">
          <i class="fas fa-user-tie"></i> Administrativo
        </button>
      </div>

      <input type="hidden" name="role" id="role" value="alumno">

      <div id="error-message" class="hidden">Usuario o contraseña incorrectos</div>

      <div class="input-group">
        <label for="usuario">Usuario</label>
        <input type="text" id="usuario" name="usuario" required />
      </div>

     <div class="input-group">
  <label for="password">Contraseña</label>
  <div class="password-wrapper">
    <input type="password" id="password" name="password" required />
    <button type="button" id="togglePassword" aria-label="Mostrar/Ocultar">
      <i class="fas fa-eye"></i>
    </button>
  </div>
</div>


      <button type="submit">Ingresar</button>
    </form>
  </div>
</div>

<script>
  const params = new URLSearchParams(window.location.search);
  if (params.get('error') === '1') {
    document.getElementById('error-message').classList.remove('hidden');
  }

  const roleButtons = document.querySelectorAll(".role-btn");
  const hiddenRoleInput = document.getElementById("role");

  roleButtons.forEach(btn => {
    btn.addEventListener("click", () => {
      roleButtons.forEach(b => b.classList.remove("activo"));
      btn.classList.add("activo");
      hiddenRoleInput.value = btn.dataset.role;
    });
  });

  // Mostrar/ocultar contraseña
  const passwordInput = document.getElementById("password");
  const togglePasswordBtn = document.getElementById("togglePassword");
  const toggleIcon = togglePasswordBtn.querySelector("i");

  togglePasswordBtn.addEventListener("click", () => {
    const tipo = passwordInput.type === "password" ? "text" : "password";
    passwordInput.type = tipo;
    toggleIcon.classList.toggle("fa-eye");
    toggleIcon.classList.toggle("fa-eye-slash");
  });

  const errorDiv = document.getElementById('error-message');

  if (params.get('error') === 'credenciales') {
    errorDiv.textContent = "Usuario o contraseña incorrectos.";
    errorDiv.classList.remove("hidden");
  }

  if (params.get('error') === 'rol') {
    const rolReal = params.get('rolReal');
    let nombreRol = rolReal === "alumno" ? "Alumno" :
                    rolReal === "docente" ? "Docente" :
                    rolReal === "administrativo" ? "Administrativo" : rolReal;

    errorDiv.textContent = `Tu cuenta pertenece al rol: ${nombreRol}`;
    errorDiv.classList.remove("hidden");
  }
  
</script>
 

<script src="/js/transition.js"></script>

</body>
</html>